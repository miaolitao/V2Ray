name: æ›´æ–°èŠ‚ç‚¹

on:
  # å®šæ—¶è§¦å‘ï¼ˆæ¯ 6 å°æ—¶ï¼‰
  schedule:
    - cron: '0 */6 * * *'
  
  # æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:
    inputs:
      skip_test:
        description: 'è·³è¿‡æµ‹é€Ÿ'
        required: false
        type: boolean
        default: false
      format:
        description: 'è¾“å‡ºæ ¼å¼'
        required: false
        type: choice
        options:
          - all
          - base64
          - clash
          - v2ray
          - surge
          - quantumult
        default: all

jobs:
  update:
    runs-on: ubuntu-latest
    
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
      
      - name: è®¾ç½® Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9'
      
      - name: å®‰è£… uv
        run: |
          curl -LsSf https://astral.sh/uv/install.sh | sh
          echo "$HOME/.cargo/bin" >> $GITHUB_PATH
      
      - name: å®‰è£…ä¾èµ–
        run: |
          uv pip install --system -e .
      
      - name: è¿è¡ŒèŠ‚ç‚¹æ›´æ–°
        run: |
          if [ "${{ github.event.inputs.skip_test }}" = "true" ]; then
            python main.py --skip-test --format ${{ github.event.inputs.format || 'all' }}
          else
            python main.py --format ${{ github.event.inputs.format || 'all' }}
          fi
      
      - name: è¯»å–ç»Ÿè®¡ä¿¡æ¯
        id: stats
        run: |
          if [ -f output/latest/stats.json ]; then
            TOTAL=$(jq -r '.total_nodes' output/latest/stats.json)
            VALID=$(jq -r '.valid_nodes' output/latest/stats.json)
            echo "total_nodes=$TOTAL" >> $GITHUB_OUTPUT
            echo "valid_nodes=$VALID" >> $GITHUB_OUTPUT
          else
            echo "total_nodes=0" >> $GITHUB_OUTPUT
            echo "valid_nodes=0" >> $GITHUB_OUTPUT
          fi
      
      - name: å‡†å¤‡ GitHub Pages å†…å®¹
        run: |
          # åˆ›å»º gh-pages ç›®å½•
          mkdir -p gh-pages
          
          # è·å–å½“å‰æ—¶é—´æˆ³ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
          TIMESTAMP=$(TZ='Asia/Shanghai' date '+%Y-%m-%d_%H-%M-%S')
          echo "å½“å‰æ—¶é—´æˆ³: $TIMESTAMP"
          
          # å¤åˆ¶æœ€æ–°çš„è¾“å‡ºæ–‡ä»¶åˆ° gh-pages æ ¹ç›®å½•
          cp -r output/latest/* gh-pages/
          
          # åˆ›å»ºå†å²ç‰ˆæœ¬ç›®å½•
          mkdir -p gh-pages/history/$TIMESTAMP
          cp -r output/latest/* gh-pages/history/$TIMESTAMP/
          
          # æ£€å‡º gh-pages åˆ†æ”¯è·å–å†å²è®°å½•
          git fetch origin gh-pages || true
          git checkout gh-pages -- history.json 2>/dev/null || echo '{"versions":[]}' > history.json
          git checkout main
          
          # æ›´æ–° history.jsonï¼ˆä¿ç•™æœ€è¿‘10æ¬¡ï¼‰
          python3 << PYTHON_SCRIPT
          import json
          from datetime import datetime
          
          # è¯»å–ç°æœ‰å†å²
          try:
              with open('history.json', 'r', encoding='utf-8') as f:
                  history = json.load(f)
          except:
              history = {"versions": []}
          
          # è¯»å–å½“å‰ç»Ÿè®¡ä¿¡æ¯
          try:
              with open('output/latest/stats.json', 'r', encoding='utf-8') as f:
                  stats = json.load(f)
          except:
              stats = {}
          
          # ä½¿ç”¨ä¼ å…¥çš„æ—¶é—´æˆ³
          timestamp = "$TIMESTAMP"
          
          # æ·»åŠ æ–°ç‰ˆæœ¬
          new_version = {
              "timestamp": timestamp,
              "update_time": stats.get('update_time', ''),
              "total_nodes": stats.get('total_nodes', 0),
              "valid_nodes": stats.get('valid_nodes', 0),
              "protocols": stats.get('protocols', {})
          }
          
          history["versions"].insert(0, new_version)
          
          # åªä¿ç•™æœ€è¿‘10æ¬¡
          history["versions"] = history["versions"][:10]
          
          # ä¿å­˜åˆ° gh-pages ç›®å½•
          with open('gh-pages/history.json', 'w', encoding='utf-8') as f:
              json.dump(history, f, ensure_ascii=False, indent=2)
          
          print(f"âœ… å†å²è®°å½•å·²æ›´æ–°ï¼Œå½“å‰ç‰ˆæœ¬æ•°ï¼š{len(history['versions'])}")
          print(f"âœ… æ—¶é—´æˆ³ï¼š{timestamp}")
          PYTHON_SCRIPT
          
          # åˆ›å»ºä¸€ä¸ªç®€å•çš„ index.html
          cat > gh-pages/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="zh-CN">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>V2Ray å…è´¹èŠ‚ç‚¹è®¢é˜…</title>
              <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      min-height: 100vh;
                      padding: 20px;
                  }
                  .container {
                      max-width: 800px;
                      margin: 0 auto;
                      background: white;
                      border-radius: 10px;
                      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
                      padding: 40px;
                  }
                  h1 {
                      color: #333;
                      margin-bottom: 10px;
                      font-size: 32px;
                  }
                  .subtitle {
                      color: #666;
                      margin-bottom: 30px;
                      font-size: 16px;
                  }
                  .stats {
                      display: grid;
                      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                      gap: 15px;
                      margin-bottom: 30px;
                  }
                  .stat-card {
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      color: white;
                      padding: 20px;
                      border-radius: 8px;
                      text-align: center;
                  }
                  .stat-value {
                      font-size: 32px;
                      font-weight: bold;
                      margin-bottom: 5px;
                  }
                  .stat-label {
                      font-size: 14px;
                      opacity: 0.9;
                  }
                  .links {
                      background: #f8f9fa;
                      padding: 25px;
                      border-radius: 8px;
                      margin-bottom: 20px;
                  }
                  .links h2 {
                      color: #333;
                      margin-bottom: 15px;
                      font-size: 20px;
                  }
                  .link-item {
                      background: white;
                      padding: 15px;
                      border-radius: 6px;
                      margin-bottom: 10px;
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      border: 1px solid #e0e0e0;
                  }
                  .link-item:last-child { margin-bottom: 0; }
                  .link-name {
                      font-weight: 600;
                      color: #333;
                      margin-bottom: 5px;
                  }
                  .link-url {
                      font-family: monospace;
                      font-size: 13px;
                      color: #666;
                      word-break: break-all;
                      flex: 1;
                      margin-right: 10px;
                  }
                  .copy-btn {
                      background: #667eea;
                      color: white;
                      border: none;
                      padding: 8px 16px;
                      border-radius: 4px;
                      cursor: pointer;
                      font-size: 14px;
                      white-space: nowrap;
                  }
                  .copy-btn:hover {
                      background: #5568d3;
                  }
                  .footer {
                      text-align: center;
                      color: #666;
                      font-size: 14px;
                      margin-top: 30px;
                      padding-top: 20px;
                      border-top: 1px solid #e0e0e0;
                  }
                  .update-time {
                      color: #999;
                      font-size: 13px;
                      margin-top: 20px;
                  }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>ğŸš€ V2Ray å…è´¹èŠ‚ç‚¹è®¢é˜…</h1>
                  <p class="subtitle">æ¯ 6 å°æ—¶è‡ªåŠ¨æ›´æ–° | å¤šç§å®¢æˆ·ç«¯æ”¯æŒ</p>
                  
                  <div class="stats" id="stats">
                      <div class="stat-card">
                          <div class="stat-value" id="total">-</div>
                          <div class="stat-label">æ€»èŠ‚ç‚¹æ•°</div>
                      </div>
                      <div class="stat-card">
                          <div class="stat-value" id="valid">-</div>
                          <div class="stat-label">æœ‰æ•ˆèŠ‚ç‚¹</div>
                      </div>
                  </div>
                  
                  <div class="links">
                      <h2>ğŸ“œ å†å²ç‰ˆæœ¬</h2>
                      <div id="history-list" style="max-height: 600px; overflow-y: auto;">
                          <p style="text-align: center; color: #999; padding: 20px;">åŠ è½½ä¸­...</p>
                      </div>
                  </div>
                  
                  <div class="footer">
                      <p>âš ï¸ å…è´¹èŠ‚ç‚¹ä»…ä¾›å­¦ä¹ æµ‹è¯•ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”</p>
                      <p class="update-time">æ›´æ–°æ—¶é—´ï¼š<span id="update-time">-</span></p>
                      <p style="margin-top: 10px;">
                          <a href="https://github.com/miaolitao/V2Ray" target="_blank" style="color: #667eea; text-decoration: none;">
                              â­ GitHub é¡¹ç›®åœ°å€
                          </a>
                      </p>
                  </div>
              </div>
              
              <script>
                  fetch('./stats.json')
                      .then(res => res.json())
                      .then(data => {
                          document.getElementById('total').textContent = data.total_nodes || 0;
                          document.getElementById('valid').textContent = data.valid_nodes || 0;
                          if (data.update_time) {
                              document.getElementById('update-time').textContent = new Date(data.update_time).toLocaleString('zh-CN', {
                                  timeZone: 'Asia/Shanghai',
                                  year: 'numeric',
                                  month: '2-digit',
                                  day: '2-digit',
                                  hour: '2-digit',
                                  minute: '2-digit',
                                  second: '2-digit',
                                  hour12: false
                              });
                          }
                      })
                      .catch(err => console.error('åŠ è½½ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:', err));
                  
                  // åŠ è½½å†å²ç‰ˆæœ¬
                  fetch('./history.json')
                      .then(res => res.json())
                      .then(history => {
                          const historyList = document.getElementById('history-list');
                          if (!history.versions || history.versions.length === 0) {
                              historyList.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">æš‚æ— å†å²è®°å½•</p>';
                              return;
                          }
                          
                          historyList.innerHTML = history.versions.map((version, index) => {
                              const updateTime = version.update_time ? new Date(version.update_time).toLocaleString('zh-CN', {
                                  timeZone: 'Asia/Shanghai',
                                  year: 'numeric',
                                  month: '2-digit',
                                  day: '2-digit',
                                  hour: '2-digit',
                                  minute: '2-digit',
                                  hour12: false
                              }) : '-';
                              
                              const badge = index === 0 ? '<span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 3px; font-size: 12px; margin-left: 10px;">æœ€æ–°</span>' : '';
                              
                              return `
                                  <div class="link-item" style="cursor: pointer;" onclick="window.location.href='./history.html?v=${version.timestamp}'">
                                      <div style="flex: 1;">
                                          <div class="link-name">
                                              ${updateTime} ${badge}
                                          </div>
                                          <div style="font-size: 13px; color: #999; margin-top: 5px;">
                                              æ€»èŠ‚ç‚¹: ${version.total_nodes} | æœ‰æ•ˆ: ${version.valid_nodes}
                                          </div>
                                      </div>
                                      <button class="copy-btn" onclick="event.stopPropagation(); window.location.href='./history.html?v=${version.timestamp}'">æŸ¥çœ‹è¯¦æƒ…</button>
                                  </div>
                              `;
                          }).join('');
                      })
                      .catch(err => {
                          console.error('åŠ è½½å†å²ç‰ˆæœ¬å¤±è´¥:', err);
                          document.getElementById('history-list').innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">åŠ è½½å¤±è´¥</p>';
                      });
              </script>
          </body>
          </html>
          EOF
          
          # åˆ›å»ºå†å²ç‰ˆæœ¬è¯¦æƒ…é¡µ
          cat > gh-pages/history.html << 'EOF'
          <!DOCTYPE html>
          <html lang="zh-CN">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>å†å²ç‰ˆæœ¬è¯¦æƒ… - V2Ray å…è´¹èŠ‚ç‚¹è®¢é˜…</title>
              <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      min-height: 100vh;
                      padding: 20px;
                  }
                  .container {
                      max-width: 800px;
                      margin: 0 auto;
                      background: white;
                      border-radius: 10px;
                      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
                      padding: 40px;
                  }
                  h1 {
                      color: #333;
                      margin-bottom: 10px;
                      font-size: 32px;
                  }
                  .subtitle {
                      color: #666;
                      margin-bottom: 30px;
                      font-size: 16px;
                  }
                  .back-btn {
                      display: inline-block;
                      color: #667eea;
                      text-decoration: none;
                      margin-bottom: 20px;
                      font-size: 16px;
                  }
                  .back-btn:hover {
                      text-decoration: underline;
                  }
                  .stats {
                      display: grid;
                      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                      gap: 15px;
                      margin-bottom: 30px;
                  }
                  .stat-card {
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      color: white;
                      padding: 20px;
                      border-radius: 8px;
                      text-align: center;
                  }
                  .stat-value {
                      font-size: 32px;
                      font-weight: bold;
                      margin-bottom: 5px;
                  }
                  .stat-label {
                      font-size: 14px;
                      opacity: 0.9;
                  }
                  .links {
                      background: #f8f9fa;
                      padding: 25px;
                      border-radius: 8px;
                      margin-bottom: 20px;
                  }
                  .links h2 {
                      color: #333;
                      margin-bottom: 15px;
                      font-size: 20px;
                  }
                  .link-item {
                      background: white;
                      padding: 15px;
                      border-radius: 6px;
                      margin-bottom: 10px;
                      display: flex;
                      justify-content: space-between;
                      align-items: center;
                      border: 1px solid #e0e0e0;
                  }
                  .link-item:last-child { margin-bottom: 0; }
                  .link-name {
                      font-weight: 600;
                      color: #333;
                      margin-bottom: 5px;
                  }
                  .link-url {
                      font-family: monospace;
                      font-size: 13px;
                      color: #666;
                      word-break: break-all;
                      flex: 1;
                      margin-right: 10px;
                  }
                  .copy-btn {
                      background: #667eea;
                      color: white;
                      border: none;
                      padding: 8px 16px;
                      border-radius: 4px;
                      cursor: pointer;
                      font-size: 14px;
                      white-space: nowrap;
                  }
                  .copy-btn:hover {
                      background: #5568d3;
                  }
                  .footer {
                      text-align: center;
                      color: #666;
                      font-size: 14px;
                      margin-top: 30px;
                      padding-top: 20px;
                      border-top: 1px solid #e0e0e0;
                  }
              </style>
          </head>
          <body>
              <div class="container">
                  <a href="./" class="back-btn">â† è¿”å›é¦–é¡µ</a>
                  
                  <h1>ğŸ“œ å†å²ç‰ˆæœ¬è¯¦æƒ…</h1>
                  <p class="subtitle" id="version-time">åŠ è½½ä¸­...</p>
                  
                  <div class="stats" id="stats">
                      <div class="stat-card">
                          <div class="stat-value" id="total">-</div>
                          <div class="stat-label">æ€»èŠ‚ç‚¹æ•°</div>
                      </div>
                      <div class="stat-card">
                          <div class="stat-value" id="valid">-</div>
                          <div class="stat-label">æœ‰æ•ˆèŠ‚ç‚¹</div>
                      </div>
                  </div>
                  
                  <div class="links">
                      <h2>ğŸ“± è®¢é˜…é“¾æ¥</h2>
                      <div class="link-item">
                          <div>
                              <div class="link-name">Base64 é€šç”¨è®¢é˜…</div>
                              <div class="link-url" id="base64-url"></div>
                          </div>
                          <button class="copy-btn" onclick="copyLink('base64')">å¤åˆ¶</button>
                      </div>
                      <div class="link-item">
                          <div>
                              <div class="link-name">Clash è®¢é˜…</div>
                              <div class="link-url" id="clash-url"></div>
                          </div>
                          <button class="copy-btn" onclick="copyLink('clash')">å¤åˆ¶</button>
                      </div>
                      <div class="link-item">
                          <div>
                              <div class="link-name">Surge è®¢é˜…</div>
                              <div class="link-url" id="surge-url"></div>
                          </div>
                          <button class="copy-btn" onclick="copyLink('surge')">å¤åˆ¶</button>
                      </div>
                      <div class="link-item">
                          <div>
                              <div class="link-name">Quantumult X è®¢é˜…</div>
                              <div class="link-url" id="quantumult-url"></div>
                          </div>
                          <button class="copy-btn" onclick="copyLink('quantumult')">å¤åˆ¶</button>
                      </div>
                  </div>
                  
                  <div class="footer">
                      <p>âš ï¸ å…è´¹èŠ‚ç‚¹ä»…ä¾›å­¦ä¹ æµ‹è¯•ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”</p>
                      <p style="margin-top: 10px;">
                          <a href="https://github.com/miaolitao/V2Ray" target="_blank" style="color: #667eea; text-decoration: none;">
                              â­ GitHub é¡¹ç›®åœ°å€
                          </a>
                      </p>
                  </div>
              </div>
              
              <script>
                  const urlParams = new URLSearchParams(window.location.search);
                  const version = urlParams.get('v');
                  
                  if (!version) {
                      document.getElementById('version-time').textContent = 'æœªæŒ‡å®šç‰ˆæœ¬';
                  } else {
                      const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^/]*$/, '');
                      const versionPath = `${baseUrl}/history/${version}`;
                      
                      const links = {
                          base64: `${versionPath}/nodes.txt`,
                          clash: `${versionPath}/clash.yaml`,
                          surge: `${versionPath}/surge.conf`,
                          quantumult: `${versionPath}/quantumult.conf`
                      };
                      
                      document.getElementById('base64-url').textContent = links.base64;
                      document.getElementById('clash-url').textContent = links.clash;
                      document.getElementById('surge-url').textContent = links.surge;
                      document.getElementById('quantumult-url').textContent = links.quantumult;
                      
                      // åŠ è½½è¯¥ç‰ˆæœ¬çš„ç»Ÿè®¡ä¿¡æ¯
                      fetch(`./history/${version}/stats.json`)
                          .then(res => res.json())
                          .then(data => {
                              document.getElementById('total').textContent = data.total_nodes || 0;
                              document.getElementById('valid').textContent = data.valid_nodes || 0;
                              if (data.update_time) {
                                  document.getElementById('version-time').textContent = 'æ›´æ–°æ—¶é—´ï¼š' + new Date(data.update_time).toLocaleString('zh-CN', {
                                      timeZone: 'Asia/Shanghai',
                                      year: 'numeric',
                                      month: '2-digit',
                                      day: '2-digit',
                                      hour: '2-digit',
                                      minute: '2-digit',
                                      second: '2-digit',
                                      hour12: false
                                  });
                              }
                          })
                          .catch(err => {
                              console.error('åŠ è½½ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:', err);
                              document.getElementById('version-time').textContent = 'åŠ è½½å¤±è´¥';
                          });
                      
                      function copyLink(type) {
                          const link = links[type];
                          navigator.clipboard.writeText(link).then(() => {
                              alert('âœ… é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n' + link);
                          }).catch(err => {
                              console.error('å¤åˆ¶å¤±è´¥:', err);
                              alert('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                          });
                      }
                  }
              </script>
          </body>
          </html>
          EOF
          
          echo "âœ… GitHub Pages å†…å®¹å‡†å¤‡å®Œæˆ"
          ls -la gh-pages/
      
      - name: éƒ¨ç½²åˆ° GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./gh-pages
          publish_branch: gh-pages
          keep_files: true
          commit_message: "ğŸ”„ æ›´æ–°èŠ‚ç‚¹ - $(date '+%Y-%m-%d %H:%M:%S')"
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
      
      - name: æ¸…ç†æ—§ç‰ˆæœ¬ï¼ˆä¿ç•™æœ€è¿‘10æ¬¡ï¼‰
        run: |
          # æ¸…ç†å·¥ä½œåŒº
          git reset --hard HEAD
          git clean -fd
          
          # æ£€å‡º gh-pages åˆ†æ”¯
          git fetch origin gh-pages || echo "gh-pages åˆ†æ”¯ä¸å­˜åœ¨ï¼Œè·³è¿‡æ¸…ç†"
          
          # å°è¯•åˆ‡æ¢åˆ° gh-pages åˆ†æ”¯
          if git show-ref --verify --quiet refs/remotes/origin/gh-pages; then
            git checkout -B gh-pages origin/gh-pages
            
            # æ£€æŸ¥ history ç›®å½•æ˜¯å¦å­˜åœ¨
            if [ -d "history" ]; then
              cd history
              
              # è·å–ç›®å½•æ•°é‡
              DIR_COUNT=$(ls -1 | wc -l)
              echo "å½“å‰å†å²ç‰ˆæœ¬æ•°ï¼š$DIR_COUNT"
              
              # åªæœ‰è¶…è¿‡10ä¸ªæ—¶æ‰æ¸…ç†
              if [ "$DIR_COUNT" -gt 10 ]; then
                echo "å¼€å§‹æ¸…ç†æ—§ç‰ˆæœ¬..."
                ls -t | tail -n +11 | xargs -r rm -rf
                cd ..
                
                # æäº¤æ¸…ç†åçš„å†…å®¹
                git config --local user.email "github-actions[bot]@users.noreply.github.com"
                git config --local user.name "github-actions[bot]"
                
                git add .
                git commit -m "ğŸ§¹ æ¸…ç†æ—§ç‰ˆæœ¬ï¼ˆä¿ç•™æœ€è¿‘10æ¬¡ï¼‰"
                git push origin gh-pages
                echo "âœ… å·²æ¸…ç†æ—§ç‰ˆæœ¬"
              else
                echo "ç‰ˆæœ¬æ•°æœªè¶…è¿‡10ä¸ªï¼Œæ— éœ€æ¸…ç†"
              fi
            else
              echo "history ç›®å½•ä¸å­˜åœ¨ï¼Œè·³è¿‡æ¸…ç†"
            fi
          else
            echo "gh-pages åˆ†æ”¯ä¸å­˜åœ¨ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡éƒ¨ç½²ï¼Œè·³è¿‡æ¸…ç†"
          fi
      
      - name: ä¸Šä¼ äº§ç‰©
        uses: actions/upload-artifact@v4
        with:
          name: v2ray-nodes-${{ github.run_number }}
          path: |
            output/
            logs/
          retention-days: 7

